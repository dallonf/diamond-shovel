var Resource = require('deployd/lib/resource')
  , util = require('util');

function Rewrite(name, options) {
  Resource.apply(this, arguments);
  this.rewriteUrl = this.config.rewriteUrl || '/index.html';
}
util.inherits(Rewrite, Resource);
module.exports = Rewrite;

Rewrite.basicDashboard = {
  settings: [{
      name: 'rewriteUrl'
    , type: 'text'
  }]
}

Rewrite.prototype.handle = function (ctx, next) {
  if(ctx.method !== 'GET' || ctx.req.internal) return next();

  ctx.req.url = this.rewriteUrl;

  ctx.server.router.route(ctx.req, ctx.res);
}